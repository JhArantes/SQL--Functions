-- Sugestão para exibir os dados de venda agrupado
-- por forma de pagamento, ano e mês.
SELECT  P.CD_FORMA_PAGTO,
        FP.DS_FORMA_PAGTO,
        EXTRACT( YEAR FROM P.DT_PEDIDO) ANO_VENDA,
		EXTRACT( MONTH FROM P.DT_PEDIDO) MES_VENDA,
		SUM(P.VL_TOT_PEDIDO) VL_TOTAL_VENDA
FROM    DB_PEDIDO P INNER JOIN DB_FORMA_PAGAMENTO FP
ON (P.CD_FORMA_PAGTO = FP.CD_FORMA_PAGTO)
GROUP BY  P.CD_FORMA_PAGTO,
        FP.DS_FORMA_PAGTO,
        EXTRACT( YEAR FROM P.DT_PEDIDO),
        EXTRACT( MONTH FROM P.DT_PEDIDO)
ORDER BY 1,2,3;
